var TestRotate=pc.createScript("testRotate");TestRotate.prototype.initialize=function(){},TestRotate.prototype.update=function(t){this.entity.rotate(0,-40*t,0)};class GameGUI{static GUIEvent(e,a,t=1){var G=(new Date).getTime();if(GameGUI.events.length>0)GameGUI.events.push({func:e,args:a,timeMult:t});else if(0==GameGUI.events.length&&G>GameGUI.nextEventTime){var r=e.apply(GameGUI,a)*t;GameGUI.nextEventTime=G+r}else GameGUI.events.push({func:e,args:a,timeMult:t}),setTimeout(GameGUI.nextGUIEvent,GameGUI.nextEventTime-G)}static addNextGUIEvent(e,a,t=1){var G=(new Date).getTime();0==GameGUI.events.length&&setTimeout(GameGUI.nextGUIEvent,GameGUI.nextEventTime-G),GameGUI.events.unshift({func:e,args:a,timeMult:t})}static nextGUIEvent(){var e=(new Date).getTime(),a=GameGUI.events.shift();if(void 0!==a){var t=a.func.apply(GameGUI,a.args)*a.timeMult;GameGUI.nextEventTime=e+t,GameGUI.events.length>0&&setTimeout(GameGUI.nextGUIEvent,t)}}static flipEmAll(){for(var e=0;e<GameGUI.GUIRoots.length;e++)for(var a=0;a<GameGUI.GUIRoots[e].guiCards.length;a++)GameGUI.GUIRoots[e].guiCards[a].script.cardBack.flip(200)}static lerp(e,a,t){return new pc.Vec3(e.x*t+a.x*(1-t),e.y*t+a.y*(1-t),e.z*t+a.z*(1-t))}static setupBoard(e,a){GameGUI.nextEventTime=0,GameGUI.events=[];var t=pc.Application.getApplication();if(GameGUI.GUIRoots=[t.root.findByName("Bottom")],GameGUI.GUIRoots[0]._outward=new pc.Vec2(0,1),t.root.findByName("Bottom").enabled=!0,2==e.length)e[0].isUserPerspective?(e[0]._guiID=0,e[1]._guiID=1):(e[0]._guiID=1,e[1]._guiID=0),GameGUI.GUIRoots.push(t.root.findByName("Top")),GameGUI.GUIRoots[1]._outward=new pc.Vec2(0,-1),t.root.findByName("Top").enabled=!0;else{if(!(e.length<5))throw"Attempted to start a game with an invalid amount of players!";for(var G=1,r=0;r<e.length;r+=1)e[r].isUserPerspective?e[r]._guiID=0:(e[r]._guiID=G,G+=1);GameGUI.GUIRoots.push(t.root.findByName("Left")),GameGUI.GUIRoots[1]._outward=new pc.Vec2(-1,0),t.root.findByName("Left").enabled=!0,4==e.length?(GameGUI.GUIRoots.push(t.root.findByName("Top")),GameGUI.GUIRoots[2]._outward=new pc.Vec2(0,-1),t.root.findByName("Top").enabled=!0,GameGUI.GUIRoots.push(t.root.findByName("Right")),GameGUI.GUIRoots[3]._outward=new pc.Vec2(1,0),t.root.findByName("Right").enabled=!0):(GameGUI.GUIRoots.push(t.root.findByName("Right")),GameGUI.GUIRoots[2]._outward=new pc.Vec2(1,0),t.root.findByName("Right").enabled=!0)}for(r=0;r<e.length;r++)GameGUI.GUIRoots[e[r]._guiID].findByName("Name").element.text=e[r].name;for(r=0;r<GameGUI.GUIRoots.length;r+=1)GameGUI.GUIRoots[r].guiCards=[];var s,i=t.root.findByName("cardPrefab");t.root.findByName("Background");GameGUI.cards=[],GameGUI.cardValues=[];for(r=0;r<52;r+=1)(s=i.clone()).setPosition(0,0,21.5-r/51),s.script.cardBack.init(a[r]),GameGUI.cards.push(s),GameGUI.cardValues.push(a[r]),t.root.addChild(s);for(r=0;r<e.length;r+=1)e[r]._guiCards=0,GameGUI.GUIRoots[e[r]._guiID]._leftBound=GameGUI.GUIRoots[e[r]._guiID].findByName("Left Bound").getPosition(),GameGUI.GUIRoots[e[r]._guiID]._rightBound=GameGUI.GUIRoots[e[r]._guiID].findByName("Right Bound").getPosition()}static cardFromDeck(e,a){soundEffects.singleDeal();var t=GameGUI.cards[GameGUI.cardValues.indexOf(e)],G=GameGUI.GUIRoots[a._guiID];return G.guiCards.splice(Math.floor(G.guiCards.length/2),0,t),GameGUI.reformDeck(a),a.isUserPerspective?t.script.cardBack.flip(500):0!=G._outward.x&&t.script.cardBack.playerRotate(G._outward,200),500}static reformDeck(e){var a=GameGUI.GUIRoots[e._guiID];if(Math.abs(a._rightBound.x-a._leftBound.x)<.01)for(var t=-(r=Math.min(4.5,Math.abs(a._leftBound.y-a._rightBound.y)/a.guiCards.length))*(a.guiCards.length-1)/2,G=0;G<a.guiCards.length;G++)a.guiCards[G].script.cardBack.moveTo(new pc.Vec3(a._leftBound.x,t+r*G,a._leftBound.z+.01*G),500,!1);else{var r;for(t=-(r=Math.min(4.5,Math.abs(a._leftBound.x-a._rightBound.x)/a.guiCards.length))*(a.guiCards.length-1)/2,G=0;G<a.guiCards.length;G++)a.guiCards[G].script.cardBack.moveTo(new pc.Vec3(t+r*G,a._leftBound.y,a._leftBound.z+.01*G),500,!1)}return 500}static newTurn(e){var a=e.index-1;-1==a&&(a=GameState.players.length-1),soundEffects.endTurn(),GameGUI.isSelecting=!1;var t=GameGUI.GUIRoots[GameState.players[a]._guiID];return t.findByName("ourTurn").enabled=!1,(t=GameGUI.GUIRoots[GameState.players[e.index]._guiID]).findByName("ourTurn").enabled=!0,50}static cardClicked(e){if(!(GameGUI.events.length>0))for(var a=0;a<GameState.players.length;a+=1)if(GameState.players[a].isUserPerspective){if(!GameState.players[a].activeTurn)return 0;if(soundEffects.select(),!GameGUI.isSelecting&&GameGUI.GUIRoots[GameState.players[a]._guiID].guiCards.includes(e))return GameGUI.isSelecting=!0,GameGUI.selectedCardValue=GameGUI.cardValues[GameGUI.cards.indexOf(e)],GameGUI.selectedCard=e,GameGUI.cardSelect(GameState.players[a],GameGUI.selectedCardValue),Networking.socket&&Networking.cardSelect(GameGUI.selectedCardValue,Networking.playerID),200;if(GameGUI.isSelecting&&!GameGUI.GUIRoots[GameState.players[a]._guiID].guiCards.includes(e)){GameGUI.isSelecting=!1;for(var t=0;t<GameState.players.length;t+=1){if(GameGUI.GUIRoots[GameState.players[t]._guiID].guiCards.includes(e))return GameState.players[a].askForCard(GameGUI.selectedCardValue,GameState.players[t])?800:(GameGUI.cardDeselect(GameState.players[a],GameGUI.selectedCardValue),100)}GameGUI.isSelecting=!0}else GameGUI.GUIRoots[GameState.players[a]._guiID].guiCards.includes(e)&&e==GameGUI.selectedCard?(GameGUI.isSelecting=!1,GameGUI.cardDeselect(GameState.players[a],GameGUI.selectedCardValue),Networking.socket&&Networking.cardDeselect(GameGUI.selectedCardValue,Networking.playerID)):GameGUI.GUIRoots[GameState.players[a]._guiID].guiCards.includes(e)&&e!=GameGUI.selectedCard&&(GameGUI.cardDeselect(GameState.players[a],GameGUI.selectedCardValue),Networking.socket&&Networking.cardDeselect(GameGUI.selectedCardValue,Networking.playerID),GameGUI.isSelecting=!0,GameGUI.selectedCardValue=GameGUI.cardValues[GameGUI.cards.indexOf(e)],GameGUI.selectedCard=e,GameGUI.cardSelect(GameState.players[a],GameGUI.selectedCardValue),Networking.socket&&Networking.cardSelect(GameGUI.selectedCardValue,Networking.playerID))}}static error(e){console.log("GameGUI Error:"+e.toString())}static cardMatch(e,a,t){soundEffects.cardMatch(),GameGUI.questionText(e,!0);for(var G=GameGUI.GUIRoots[e._guiID],r=GameGUI.GUIRoots[a._guiID],s=0;s<t.length;s++){var i=GameGUI.cards[GameGUI.cardValues.indexOf(t[s])],o=G.guiCards.indexOf(i);G.guiCards.splice(o,1),GameGUI.cardSelect(e,t[s],e.isUserPerspective!=a.isUserPerspective),i.script.cardBack.playerRotate(r._outward,200),r.guiCards.splice(Math.floor(r.guiCards.length/2),0,i)}return GameGUI.addNextGUIEvent(GameGUI.reformDeck,[e],.1),GameGUI.addNextGUIEvent(GameGUI.reformDeck,[a],.1),GameGUI.addNextGUIEvent(GameGUI.questionText,[e,null]),GameGUI.addNextGUIEvent(GameGUI.questionText,[a,null]),GameGUI.addNextGUIEvent(GameGUI.emptyWait,[800]),500}static cardSelect(e,a,t){var G=GameGUI.cards[GameGUI.cardValues.indexOf(a)],r=GameGUI.GUIRoots[e._guiID];t&&G.script.cardBack.flip(200);var s=G.getPosition();return G.script.cardBack.moveTo(new pc.Vec3(s.x+4*r._outward.x,s.y+4*r._outward.y,s.z),200),200}static questionText(e,a){var t=GameGUI.GUIRoots[e._guiID];return t.findByName("Question").element.text=!0===a?"Y":!1===a?"N":null!==a?["A","2","3","4","5","6","7","8","9","10","J","Q","K"][a%13]+" ?":"",50}static cardDeselect(e,a,t){var G=GameGUI.cards[GameGUI.cardValues.indexOf(a)],r=GameGUI.GUIRoots[e._guiID];t&&G.script.cardBack.flip(200);var s=G.getPosition();return G.script.cardBack.moveTo(new pc.Vec3(s.x-4*r._outward.x,s.y-4*r._outward.y,s.z),200),200}static updatePoints(e){return GameGUI.GUIRoots[e._guiID].findByName("Tricks").element.text=e.points.toString()+"\nPoints",0}static pointObtained(e,a){for(var t=GameGUI.GUIRoots[a._guiID],G=0;G<4;G+=1){var r=GameGUI.cards[GameGUI.cardValues.indexOf(e[G])];t.guiCards.splice(t.guiCards.indexOf(r),1);var s=r.getPosition();r.script.cardBack.moveTo(new pc.Vec3(16/3*G-8,0,s.z),200),a.isUserPerspective||r.script.cardBack.flip(200),0!=t._outward.x&&r.script.cardBack.playerRotate(new pc.Vec2(0,1),200)}return GameGUI.addNextGUIEvent(GameGUI.disappearCards,[e,t]),GameGUI.addNextGUIEvent(GameGUI.emptyWait,[600]),GameGUI.updatePoints(a)+GameGUI.reformDeck(a)}static disappearCards(e,a){for(var t=0;t<4;t+=1){var G=GameGUI.cards[GameGUI.cardValues.indexOf(e[t])],r=G.getPosition();0!==a._outward.y?G.script.cardBack.moveTo(new pc.Vec3(r.x,-40*a._outward.y,r.z),400):G.script.cardBack.moveTo(new pc.Vec3(-40*a._outward.x,r.y,r.z),400)}return 200}static emptyWait(e){return e}}class soundEffects{static Sounds;static init(){soundEffects.Sounds=pc.app.root.findByName("Sounds").sound}static select(){this.Sounds.play("pickCard")}static turn(){this.Sounds.play("turnCard")}static singleDeal(){this.Sounds.play("turnCard")}static nextTurn(){this.Sounds.play("nextTurn")}static endTurn(){this.Sounds.play("endTurn")}static cardMatch(){this.Sounds.play("cardMatch")}static cardNotMatch(){this.Sounds.play("cardNotMatch")}}class Player{constructor(e,t,a){this.cards=[],this.name=a,this.index=e,this.isUserPerspective=t,this.activeTurn=!1,this.points=0,this.lastReq=[]}askForCard(e,t){Networking.socket&&this.isUserPerspective&&Networking.askForCard(e,Networking.playerID,t._networkID),GameGUI.GUIEvent(GameGUI.questionText,[this,e]);var a=Player.cardsOfValue(t.cards,e);if(a.length>0){this.lastReq=this.cards[a];for(var r=0;r<a.length;r++)this.giveCard(a[r],t);return GameGUI.GUIEvent(GameGUI.cardMatch,[t,this,a]),this.checkPoints(),0===this.cards.length&&this.endTurn(),!0}return soundEffects.cardNotMatch(),GameGUI.GUIEvent(GameGUI.questionText,[t,!1]),GameGUI.GUIEvent(GameGUI.emptyWait,[500]),GameGUI.GUIEvent(GameGUI.questionText,[this,null]),GameGUI.GUIEvent(GameGUI.questionText,[t,null]),this.drawCard(),!1}giveCard(e,t){this.cards.push(e),t.cards.splice(t.cards.indexOf(e),1)}drawCard(){var e;GameState.deck.length>0?(e=GameState.giveCardFromDeck(this),this.cards.push(e),GameGUI.GUIEvent(GameGUI.cardFromDeck,[e,this]),this.checkPoints()):GameGUI.GUIEvent(GameGUI.reformDeck,[this]);this.endTurn()}checkPoints(){for(var e=0;e<this.cards.length;e+=1){var t=Player.cardsOfValue(this.cards,this.cards[e]);if(4==t.length){for(var a=0;a<4;a+=1)this.cards.splice(this.cards.indexOf(t[a]),1);return this.points+=1,void GameGUI.GUIEvent(GameGUI.pointObtained,[t,this])}}}beginTurn(){GameGUI.GUIEvent(GameGUI.newTurn,[this]),this.activeTurn=!0,0===this.cards.length&&this.drawCard()}endTurn(){this.activeTurn=!1;var e=0;for(i=0;i<GameState.players.length;i++)0===GameState.players[i].cards.length&&e++;e>=GameState.players.length?GameGUI.GUIEvent(GameState.gameOver):GameState.players[(this.index+1)%GameState.players.length].beginTurn()}static cardValue(e){if(e>51||e<0)throw"Attempted to get the value of a card out of the deck! Attempted value:"+e.toString();return e%13}static cardSuit(e){if(e>51||e<0)throw"Attempted to get the suit of a card out of the deck! Attempted value:"+e.toString();return Math.floor(e/13)}static cardsOfValue(e,t){for(var a=[],r=0;r<4;r++){-1!=e.indexOf(Player.cardValue(t)+13*r)&&a.push(Player.cardValue(t)+13*r)}return a}}class GameState{static newOfflineGame(e,a){soundEffects.init();var t=[];GameState.players=t,GameState.difficulty=a,t.push(new Player(0,!0,"Player"));for(var r=1;r<e;r++)t.push(new AIPlayer(r,!1,"Bot"));var n=[];for(r=0;r<52;r++)n.push(r);GameState.deck=[];for(r=51;r>=0;r--){var l=Math.round(Math.random()*r);GameState.deck.push(n[l]),n.splice(l,1)}if(console.log(GameState.deck),GameGUI.setupBoard(t,GameState.deck),!(t.length<5))throw"Too many players! Current max is 4";for(r=0;r<7*t.length;r++){var p=GameState.deck.pop();t[r%t.length].cards.push(p),GameGUI.GUIEvent(GameGUI.cardFromDeck,[p,t[r%t.length]],1/t.length)}GameState.players[0].activeTurn=!0,GameGUI.GUIEvent(GameGUI.newTurn,[GameState.players[0]])}static newOnlineGame(e,a){null==a&&(a=1),GameState.difficulty=a,soundEffects.init();var t=[],r={};GameState.players=t;for(var n=0;n<e.length;n++)if("Bot"==e[n].name){var l=new AIPlayer(n,!1,"Bot");l._networkID=-1*n,r[-1*n]=l,t.push(l)}else if(e[n].playerID==Networking.playerID){(p=new Player(n,!0,e[n].name))._networkID=e[n].playerID,t.push(p),r[e[n].playerID]=p}else{var p;(p=new Player(n,!1,e[n].name))._networkID=e[n].playerID,t.push(p),r[e[n].playerID]=p}var s=[];for(n=0;n<52;n++)s.push(n);GameState.deck=[];for(n=51;n>=0;n--){var m=Math.round(Math.random()*n);GameState.deck.push(s[m]),s.splice(m,1)}if(console.log(GameState.deck),GameGUI.setupBoard(t,GameState.deck),!(t.length<5))throw"Too many players! Current max is 4";for(n=0;n<7*t.length;n++){var G=GameState.deck.pop();t[n%t.length].cards.push(G),GameGUI.GUIEvent(GameGUI.cardFromDeck,[G,t[n%t.length]],1/t.length)}return GameState.players[0].activeTurn=!0,GameGUI.GUIEvent(GameGUI.newTurn,[GameState.players[0]]),GameState.players[0].beginTurn(),r}static gameOver(){var e=pc.app.root.findByName("victoryFlipped"),a=pc.app.root.findByName("defeatFlipped"),t=GameState.players[0].points;for(i=1;i<GameState.players.length;i++)GameState.players[i].points>t&&(t=GameState.players[i].points);for(i=0;i<GameState.players.length;i++)if(!0===GameState.players[i].isUserPerspective)return GameState.players[i].points==t?(e.enabled=!0,!0):(a.enabled=!0,!0);return!1}static giveCardFromDeck(){return GameState.deck.pop()}}var CardBack=pc.createScript("cardBack");CardBack.prototype.init=function(t){this.index=t.toString(),this.cardFace=this.app.assets.find(this.index,"sprite"),this.cardBack=this.app.assets.find("back","sprite"),this.backShowing=!0,this.entity.sprite.addClip({name:this.index,fps:0,loop:!1,spriteAsset:this.cardFace}),this.entity.sprite.addClip({name:"back",fps:0,loop:!1,spriteAsset:this.cardBack}),this.entity.sprite.clip("back").spriteAsset=this.cardBack.id,this.entity.sprite.play("back"),this.started=!0,this.notSwapped=!0},CardBack.prototype.update=function(t){if(null!=this.endSpot)if((e=((new Date).getTime()-this.startTime)/this.totalTime)<1){var i=new pc.Vec3(this.endSpot.x*e+this.startSpot.x*(1-e),this.endSpot.y*e+this.startSpot.y*(1-e),this.endSpot.z*e+this.startSpot.z*(1-e));this.entity.setPosition(i)}else this.entity.setPosition(this.endSpot),this.endSpot=null;if(null!=this.rot){var e=((new Date).getTime()-this.rotStartTime)/this.rotTotalTime;!this.backShowing&&this.notSwapped&&e>=.5?(this.entity.sprite.clip("back").spriteAsset=this.cardBack.id,this.entity.sprite.play("back"),this.backShowing=!0,this.notSwapped=!1):this.backShowing&&this.notSwapped&&e>=.5&&(this.entity.sprite.clip(this.index).spriteAsset=this.cardFace.id,this.entity.sprite.play(this.index),this.backShowing=!1,this.notSwapped=!1),this.entity.setEulerAngles(0,this.rot*e+this.originalRot*(1-e),0),e>=1&&(this.entity.setEulerAngles(0,this.rot,0),this.rot=null,this.notSwapped=!0)}if(null!=this.playerRot){e=((new Date).getTime()-this.playerRotStartTime)/this.playerRotTotalTime;var s=this.entity.getEulerAngles();this.entity.setEulerAngles(s.x,s.y,this.playerRot*e+this.originalPlayerRot*(1-e)),e>=1&&(this.entity.setEulerAngles(s.x,s.y,this.playerRot),this.playerRot=null)}},CardBack.prototype.moveTo=function(t,i,e){var s=(new Date).getTime();this.startSpot=this.entity.getPosition(),this.endSpot=t,this.totalTime=i,this.startTime=s},CardBack.prototype.flip=function(t){var i=(new Date).getTime();this.originalRot=this.entity.getEulerAngles().y,this.rot=this.entity.getEulerAngles().y+180,this.rotTotalTime=t,this.rotStartTime=i,soundEffects.turn()},CardBack.prototype.playerRotate=function(t,i){var e=(new Date).getTime();this.playerRot=90*t.x,this.originalPlayerRot=this.entity.getEulerAngles().z,this.playerRot!=this.originalPlayerRot?(this.playerRotStartTime=e,this.playerRotTotalTime=i):this.playerRot=null};var Test=pc.createScript("test");Test.prototype.initialize=function(){},Test.prototype.update=function(t){};class AIPlayer extends Player{beginTurn(){this.activeTurn=!0,GameGUI.GUIEvent(GameGUI.newTurn,[this]),GameGUI.GUIEvent(GameGUI.emptyWait,[400]);GameState.difficulty;do{if(0===this.cards.length){this.drawCard();break}this.activeTurn=this.aiRequest(GameState.difficulty)}while(this.activeTurn)}aiRequest(a){if(1==a){var t=this.cards[Math.floor(Math.random()*this.cards.length)];return GameGUI.GUIEvent(GameGUI.cardSelect,[this,t]),(e=GameState.players[Math.floor(Math.random()*GameState.players.length)])==this&&(e=GameState.players[(this.index+1)%GameState.players.length]),this.askForCard(t,e)}if(2==a){t=this.mostCommonCard();GameGUI.GUIEvent(GameGUI.cardSelect,[this,t]);var e=this.mostCards();return this.askForCard(t,e)}if(3==a){t=this.mostCommonCard();for(var r in GameGUI.GUIEvent(GameGUI.cardSelect,[this,t]),null===t&&(t=Math.max(this.cards)),GameState.players)if(GameState.players[r].lastReq==t)return this.askForCard(t,GameState.players[r]);return this.askForCard(t,this.mostCards())}}mostCommonCard(){var a,t=1,e=0;for(var r in this.cards){for(var s in this.cards)this.cards[r]==this.cards[s]&&e++,t<=e&&(t==e&&null!==a?this.cards[r]>this.cards[a]&&(a=this.cards[r]):(t=e,a=this.cards[r]));e=0}return a}mostCards(){var a=0,t=GameState.players[0];for(var e of GameState.players)e.cards.length>a&&(a=e.cards.length,t=e);return t}mostPoints(){var a=0,t=GameState.players[0];for(var e of GameState.players)e.points>a&&(a=e.points,t=e);return t}}var Picker=pc.createScript("picker");Picker.prototype.initialize=function(){this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.cameraEntity=this.findCamera(),this.picked=!1,this.pickedEntity=null},Picker.prototype.findCamera=function(){var t=pc.app.root.findByName("Camera");if(t)return t},Picker.prototype.onMouseDown=function(t){var i=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.nearClip),e=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.farClip),n=pc.app.systems.rigidbody.raycastFirst(i,e);n&&n.entity&&n.entity.script.cardBack?GameGUI.cardClicked(n.entity):n&&n.entity&&n.entity.script.menuItem?(Menu.openMenu(n.entity.script.menuItem.link,n.entity.script.menuItem.defaultTextbox),n.entity.script.actionItem&&("none"==n.entity.script.actionItem.arg?n.entity.script.actionItem.func():n.entity.script.actionItem.func(n.entity.script.actionItem.arg))):n&&n.entity&&n.entity.script.actionItem&&("none"==n.entity.script.actionItem.arg?n.entity.script.actionItem.func():n.entity.script.actionItem.func(n.entity.script.actionItem.arg))};var Defeat=pc.createScript("endScreen");Defeat.prototype.initialize=function(){},Defeat.prototype.onLoss=function(){var t={alpha:0},e=this.entity.sprite;this.app.tween(t).to({alpha:1},2,pc.Linear).loop(!1).yoyo(!1).on("update",(function(){e.opacity=t.alpha})).start()},Defeat.prototype.update=function(t){};var Victory=pc.createScript("endScreen");Victory.prototype.initialize=function(){},Victory.prototype.onWin=function(){var t={alpha:0},e=this.entity.sprite;this.app.tween(t).to({alpha:1},2,pc.Linear).loop(!1).yoyo(!1).on("update",(function(){e.opacity=t.alpha})).start()},Victory.prototype.update=function(t){};var Tie=pc.createScript("endScreen");Tie.prototype.initialize=function(){},Tie.prototype.onTie=function(){var t={alpha:0},e=this.entity.sprite;this.app.tween(t).to({alpha:1},2,pc.Linear).loop(!1).yoyo(!1).on("update",(function(){e.opacity=t.alpha})).start()},Tie.prototype.update=function(t){};pc.extend(pc,function(){var TweenManager=function(t){this._app=t,this._tweens=[],this._add=[]};TweenManager.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);this._add.length&&(this._tweens=this._tweens.concat(this._add),this._add.length=0)}};var Tween=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.Linear,this._sv={},this._ev={}},_parseProperties=function(t){var i;return t instanceof pc.Vec2?i={x:t.x,y:t.y}:t instanceof pc.Vec3?i={x:t.x,y:t.y,z:t.z}:t instanceof pc.Vec4||t instanceof pc.Quat?i={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Color?(i={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(i.a=t.a)):i=t,i};Tween.prototype={to:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this},from:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this._from=!0,this},rotate:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this._slerp=!0,this},start:function(){var t,i,e,n;if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this._properties[t],this._ev[t]=this.target[t]);this._slerp&&(this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._fromQuat.setFromEulerAngles(i,e,n))}else{for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this.target[t],this._ev[t]=this._properties[t]);this._slerp&&(this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._toQuat.setFromEulerAngles(i,e,n))}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time-=this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,n,s=0===this.duration?1:this.time/this.duration,r=this.easing(s);for(var h in this._properties)this._properties.hasOwnProperty(h)&&(e=this._sv[h],n=this._ev[h],this.target[h]=e+(n-e)*r);if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtifyLocal(),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this.entity&&this.entity.off("destroy",this.stop,this),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties){var e=this._sv[i];this._sv[i]=this._ev[i],this._ev[i]=e}this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var BounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},BounceIn=function(t){return 1-BounceOut(1-t)};return{TweenManager:TweenManager,Tween:Tween,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},BackOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:BounceIn,BounceOut:BounceOut,BounceInOut:function(t){return t<.5?.5*BounceIn(2*t):.5*BounceOut(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1,n=.4;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=n*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*.5+1)}}}()),function(){pc.Application.prototype.addTweenManager=function(){this._tweenManager=new pc.TweenManager(this),this.on("update",(function(t){this._tweenManager.update(t)}))},pc.Application.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.once("destroy",e.stop,e),i&&i.element&&(e.element=i.element),e};var t=pc.Application.getApplication();t&&t.addTweenManager()}();class Networking{static init(){this.socket=io.connect("https://dour-unequaled-nerine.glitch.me"),this.socket.on("error",(t=>{Menu.openMenu("startMenu")})),this.socket.on("playerID",(t=>{this.playerID=t,console.log("connected successfully")})),this.socket.on("botRNum",(t=>{Math.seedrandom(t)})),this.socket.on("startGame",(t=>{Menu.closeCurrentMenu(),this.playersFromID=GameState.newOnlineGame(t)})),this.socket.on("cardSelect",((t,e)=>{GameGUI.cardSelect(this.playersFromID[e],t)})),this.socket.on("cardDeselect",((t,e)=>{GameGUI.cardDeselect(this.playersFromID[e],t)})),this.socket.on("askForCard",((t,e,s)=>{this.playersFromID[e].askForCard(t,this.playersFromID[s])}))}static createLobby(t,e,s,o){this.lobbyPass=t,this.socket.emit("createLobby",t,e,s,o)}static joinLobby(t,e){this.socket.emit("joinLobby",t,e),this.lobbyPass=t}static cardSelect(t,e){this.socket.emit("cardSelect",this.lobbyPass,t,e)}static cardDeselect(t,e){this.socket.emit("cardDeselect",this.lobbyPass,t,e)}static askForCard(t,e,s){this.socket.emit("askForCard",this.lobbyPass,t,e,s)}}class Menu{static openMenu(e,n){Menu.closeCurrentMenu();var t=pc.app.root.findByName(e);t.enabled=!0,Menu.currentMenu=e,"none"!=n&&null!=n&&InputHandler.newActiveTextbox(t.findByName(n).script.textBox)}static closeCurrentMenu(){Menu.currentMenu?pc.app.root.findByName(Menu.currentMenu).enabled=!1:(pc.app.root.findByName("startMenu").enabled=!1,InputHandler.init())}}var MenuItem=pc.createScript("menuItem");MenuItem.attributes.add("link",{type:"string",default:"startMenu"}),MenuItem.attributes.add("defaultTextbox",{type:"string",default:"none"});var ActionItem=pc.createScript("actionItem");ActionItem.attributes.add("funcName",{type:"string",default:"none"}),ActionItem.attributes.add("arg",{type:"string",default:"none"}),ActionItem.prototype.initialize=function(){this.func=this[this.funcName]},ActionItem.prototype.offlineGame=function(){var t=parseInt(this.entity.parent.findByName("Bot difficulty").script.sliderParent.curValue);Menu.closeCurrentMenu(),GameState.newOfflineGame(parseInt(this.entity.parent.findByName("Number of bots").script.sliderParent.curValue)+1,t)},ActionItem.prototype.genLobby=function(){for(var t="",e="abcdefghijklmnopqrstuvwxyz",n=0;n<4;n++)t+=e.charAt(Math.floor(Math.random()*e.length));Networking._hostLob=t,pc.app.root.findByName("lobbyNameText").element.text="Lobby code: "+Networking._hostLob},ActionItem.prototype.hostGame=function(){var t=parseInt(this.entity.parent.findByName("Number of bots").script.sliderParent.curValue),e=parseInt(this.entity.parent.findByName("Total players").script.sliderParent.curValue),n=pc.app.root.findByName("hostMenu").findByName("friends").children[0].element.text;Menu.openMenu("waitingMenu"),Networking.init(),Networking.createLobby(Networking._hostLob,n,t,e)},ActionItem.prototype.joinGame=function(){var t=pc.app.root.findByName("joinMenu").findByName("Lobby Name").children[0].element.text,e=pc.app.root.findByName("joinMenu").findByName("Name").children[0].element.text;Menu.openMenu("waitingMenu"),Networking.init(),Networking.joinLobby(t,e)},ActionItem.prototype.slider=function(){this.entity.parent.parent.script.sliderParent.newClicked(this.entity.parent.name)},ActionItem.prototype.newKeyboard=function(){InputHandler.newActiveTextbox(this.entity.script.textBox)};var TextBox=pc.createScript("textBox");TextBox.attributes.add("maxCharacters",{type:"number",default:6}),TextBox.prototype.initialize=function(){this.text=this.entity.findByName("text"),this.curCharacters=0},TextBox.prototype.update=function(t){},TextBox.prototype.addKey=function(t){this.curCharacters<this.maxCharacters&&(this.text.element.text=this.text.element.text+t,this.curCharacters+=1)},TextBox.prototype.removeKey=function(){this.curCharacters>0&&(this.text.element.text=this.text.element.text.slice(0,-1),this.curCharacters-=1)};class InputHandler{static init(){pc.app.keyboard.on("keydown",InputHandler.onKeyDown,this)}static onKeyDown(t){1==t.event.key.length&&InputHandler.activeTextbox?InputHandler.activeTextbox.addKey(t.event.key):8==t.key&&InputHandler.activeTextbox.removeKey(),t.event.preventDefault()}static newActiveTextbox(t){InputHandler.activeTextbox=t}}var SliderParent=pc.createScript("sliderParent");SliderParent.attributes.add("default",{type:"string",default:"0"}),SliderParent.prototype.initialize=function(){this.newClicked(this.default)},SliderParent.prototype.newClicked=function(t){for(var e=0;e<this.entity.children.length;e++)this.entity.children[e].name!=t?this.entity.children[e].children[0].sprite.opacity=0:this.entity.children[e].children[0].sprite.opacity=1;this.curValue=t};